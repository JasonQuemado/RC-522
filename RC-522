import RPi.GPIO as GPIO
from mfrc522 import SimpleMFRC522

class Rfid:

    def __init__(self):
        GPIO.setwarnings(False)  # Desactiva warnings de GPIO
        GPIO.setmode(GPIO.BOARD)  # Usa numeración física de pines
        self.rfd = SimpleMFRC522()  # Inicializa el lector RFID

    def read_uid(self):
        try:
            while True:
                print("Esperando a que se acerque un tag...")
                id, text = self.rfd.read()  # Lee el ID y texto del tag
                print(f"ID de la tarjeta: {id}")
                print(f"Texto de la tarjeta: {text}")
                return id  # Retorna el ID del tag
        except Exception as e:
            print(f"Error: {e}")
        finally:
            self.cleanup()

    def cleanup(self):
        GPIO.cleanup()

if __name__ == "__main__":
    rf = Rfid()
    uid = rf.read_uid()
    print(uid)
    rf.cleanup()
